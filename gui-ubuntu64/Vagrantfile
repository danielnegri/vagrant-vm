Vagrant.configure("2") do |config|
  vm_type = 'gui'

  # Every Vagrant virtual environment requires a box to build off of.
  config.vm.box = 'precise64-unity'

  # The url from where the 'config.vm.box' box will be fetched.
  config.vm.box_url = 'http://dl.dropbox.com/u/36836372/precise64-unity-20120504.box'

  # Assign this VM a unique hostname
  config.vm.host_name = "#{ENV['USER']}.#{vm_type}.precise64.vagrantup.com"

  # Enable provisioning with Ansible
  config.vm.provision "ansible" do |ansible|
    ansible.playbook = "playbook-gui-ubuntu.yml"
  end

  # Use bridged networking rather than NAT
  #config.vm.network :bridged

  # Forward a port from the guest to the host (id, guest port, host port)
  config.vm.network "forwarded_port", guest: 22, host: 2198, auto_correct: true

  config.vm.provider "virtualbox" do |vb|
    # Boot with a GUI so you can see the screen. (Default is headless)
    vb.gui = true

    # Share a folder to the VM (id, guest path, host path)
    vb.share_folder "vagrant-share", "/vagrant-share", "../share"
    vb.share_folder "source", "/home/vagrant/home", ENV['HOME']

    # Set memory allocated to the VM in MB
    vb.customize ['modifyvm', :id, '--memory', '2048']
    vb.customize ['modifyvm', :id, '--cpus', '1']
    vb.customize ['modifyvm', :id, '--vram', '128']
    vb.customize ['modifyvm', :id, '--accelerate2dvideo', 'off']

    # Enable sound
    vb.customize ['modifyvm', :id, '--audio', 'coreaudio']
    vb.customize ['modifyvm', :id, '--audiocontroller', 'ac97']

    # Disable shared clipboard
    vb.customize ['modifyvm', :id, '--clipboard', 'hosttoguest']

    # https://gist.github.com/2155825
    vb.customize ['storagectl', :id, '--name', 'SATA Controller', '--hostiocache', 'on' ]
    vb.customize ['setextradata', :id, 'VBoxInternal2/SharedFoldersEnableSymlinksCreate/v-root', '1' ]
  end
end

